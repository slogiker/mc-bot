# MC-Bot

MC-Bot is a containerized Minecraft Java Server bundled with a Discord bot. It allows you to manage the server directly from Discord without requiring SSH access or router port forwarding.

The project runs entirely inside a single Docker container, managing the Minecraft server process via tmux.

## Features

- **Discord Control Panel:** Start, stop, and restart the server using Discord commands.
- **Built-in Tunneling:** Integrated Playit.gg support exposes the server to the internet without manual port forwarding.
- **Log Streaming:** Forwards live server console logs, chat messages, and player events (joins, leaves, deaths) to Discord channels.
- **Automated Backups:** Handles scheduled daily backups and manual backup triggers.
- **Role-based Permissions:** Restricts server management commands to authorized users.

## Installation (Linux)

A Linux host (Ubuntu/Debian) with Docker installed is recommended.

1. **Clone the repository and run the installer:**

   ```bash
   git clone https://github.com/slogiker/mc-bot.git
   cd mc-bot
   chmod +x install/install.sh
   ./install/install.sh
   ```

2. **Configure the Environment:**

   The script will automatically generate the `.env` file and prompt you for:
   - `BOT_TOKEN` _(Required)_: Your Discord bot token. If not provided, the bot cannot run, and you will not be able to manage the server.
   - `PLAYIT_SECRET_KEY` _(Optional)_: Your Playit.gg secret key. If omitted, the server will only be accessible over your local network unless you manually port-forward your router.
   - `RCON_PASSWORD`: This is auto-generated by the script to secure the internal bot-to-server connection. You do not need to configure this manually.

3. **Complete Setup in Discord:**

   Once the container is running and the bot is online, use the `/setup` command in your Discord server to select the Minecraft version (Vanilla, Paper, or Fabric) and generate the server files.

## Installation (Windows)

A preliminary Windows setup script (`install\install.bat`) is provided, but **it is currently a work in progress**. It attempts to automatically configure WSL2 and Docker, but you may encounter bugs if you attempt to use it natively on Windows.

## Maintenance and Updates

To update the bot to the latest version on GitHub, run the provided update script:

```bash
python install/update.py
```

This script synchronizes the local repository with the GitHub repository. It pulls the latest commits and rebuilds the Docker container from scratch to prevent caching issues, ensuring the update occurs correctly regardless of the initial installation state or local modifications.

## Useful Docker Commands

These commands are helpful for general maintenance and monitoring:

```bash
# View live logs for both the bot and the server
docker compose logs -f mc-bot

# View only the last 50 lines of logs
docker compose logs --tail=50 mc-bot

# Start the container in the background
docker compose up -d

# Stop the container safely
docker compose down

# Restart the container
docker compose restart

# Attach directly to the Minecraft server console
# (To detach without killing the server, press Ctrl+B, then press D)
docker exec -it mc-bot tmux attach -t minecraft
```

## Documentation

For a comprehensive command reference, architecture overview, and developer notes, see [`docs/information.md`](docs/information.md).
